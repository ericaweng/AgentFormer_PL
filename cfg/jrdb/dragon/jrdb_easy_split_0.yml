# ------------------- General Options -------------------------

description                  : AgentFormer (Before DLow)
results_root_dir             : results-jrdb
seed                         : 1
dataset                      : jrdb
frame_skip                   : 6
data_skip                    : 1
data_root_jrdb               : datasets/jrdb_adjusted
vis_freq                     : 1

# ------------------- Feature Extractor -------------------------

past_frames                  : 8
#past_frames_pos              : 1
future_frames                : 12
min_past_frames              : 8  # for fps=6, 8 frames = 1.3 sec
min_future_frames            : 12  # for fps=6, 12 frames = 2 sec

traj_scale                   : 1
motion_dim                   : 2
forecast_dim                 : 2

# ------------------- model -------------------------

#kp_mask:
model_id: agentformer
tf_version: v2
tf_model_dim: 256
tf_ff_dim: 512
tf_nhead: 8
tf_dropout: 0.1
input_type: ['scene_norm', 'vel']
split_type: half_and_half_tiny
concat_all_inputs: true
kp_dim: 2
num_joints: 17
dataloader_version: 2
preprocess_data: false
pred_type: 'scene_norm'
sn_out_type: 'norm'
pos_concat: true
rand_rot_scene: true # false #true
scene_orig_all_past: true

input_type_to_dims: {'scene_norm': 2, 'vel': 2, 'heading': 2, 'kp_norm': 34, 'kp_vel': 34, 'kp_scores': 17, 'cam_intrinsics': 9, 'cam_extrinsics': 7, 'cam_id': 1}
#include_cats: ['static', 'linear']  # exclude static interaction category from training
#exclude_cats_from_pred: ['static']  # exclude static interaction category from training

context_encoder:
  nlayer: 2

future_decoder:
  nlayer: 2
  out_mlp_dim: [512, 256]

future_encoder:
  nlayer: 2
#  out_mlp_dim: [512, 256]

# ------------------- vae-------------------------

nz                           : 32
sample_k                     : 5
learn_prior                  : true

# ------------------- training parameters -------------------------

lr                           : 1.e-5
loss_cfg:
  mse:
    weight: 1.0
  kld:
    weight: 1.0
    min_clip: 2.0
  sample:
    weight: 1.0
    k: 5

batch_size                   : 1
num_epochs                   : 100
lr_fix_epochs                : 10
lr_scheduler: 'step'
decay_step: 10
decay_gamma: 0.5
print_freq                   : 20
model_save_freq              : 10
